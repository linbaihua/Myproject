<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>二级菜单副本</title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
				list-style-type: none;
			}

			a,
			img {
				border: 0;
				text-decoration: none;
			}

			body {
				font: 12px/180% Arial, Helvetica, sans-serif, "新宋体";
			}
		</style>

		<link rel="stylesheet" type="text/css" href="css/sdmenu.css" />

		<script type="text/javascript" src="js/tools.js"></script>
		<script type="text/javascript">
			window.onload = function() {

					// 使用选择器语法选中元素，all是选中所有，不带all是选中第一个
					var menuspan = document.querySelectorAll(".menuSpan");

					// 获取到了第第一个div
					var openDiv = menuspan[0].parentNode;

					for (var i = 0; i < menuspan.length; i++) {
						menuspan[i].onclick = function() {

							/// var parentNode = menuspan[i].parentNode;
							// 使用this引用函数自己
							var parentDiv = this.parentNode;
							/* // 菜单开始高度
							var begin = parentDiv.offsetHeight;
							// 执行菜单动作
							toggleClass(parentDiv, "collapsed");
							// 菜单结束高度
							var end = parentDiv.offsetHeight;
							//
							parentDiv.style.height = begin + "px";
							move(parentDiv, "height", end, 10, function(){
								// 动画执行完毕，内联样式没有存在的意义了，删除
								parentDiv.style.height = "";
							}); */
							toggleMenu(parentDiv);
							// 打开新的菜单后关闭前面的菜单，关闭菜单是添加collapsed
							if (openDiv != parentDiv && !hasClass(openDiv, "collapsed")){
									// addClass(openDiv, "collapsed");
									/* 
										为了给打开和关闭添加同样的动画效果，使用相同的toggle方法
										但是不想要toggle的移除collapsed效果，所以需要在判断中判断，
										如果没有就添加，有就不进来
									*/
									// toggleClass(openDiv, "collapsed");
									toggleMenu(openDiv);
								}
								// 放在addclass后面，将上一个菜单传递到下一个菜单打开时关闭
								openDiv = parentDiv;

							};
						}
						
						// 菜单打开关闭过渡效果
						function toggleMenu(obj){
					
							// 菜单开始高度
							var begin = obj.offsetHeight;
							// 执行菜单动作
							toggleClass(obj, "collapsed");
							// 菜单结束高度
							var end = obj.offsetHeight;
							//
							obj.style.height = begin + "px";
							move(obj, "height", end, 20, function(){
								// 动画执行完毕，内联样式没有存在的意义了，删除
								obj.style.height = "";
							});
						}

					};
		</script>

	</head>

	<body>

		<div id="my_menu" class="sdmenu">
			<div>
				<span class="menuSpan">在线工具</span>
				<a href="#">图像优化</a>
				<a href="#">收藏夹图标生成器</a>
				<a href="#">邮件</a>
				<a href="#">htaccess密码</a>
				<a href="#">梯度图像</a>
				<a href="#">按钮生成器</a>
			</div>
			<div class="collapsed">
				<span class="menuSpan">支持我们</span>
				<a href="#">推荐我们</a>
				<a href="#">链接我们</a>
				<a href="#">网络资源</a>
			</div>
			<div class="collapsed">
				<span class="menuSpan">合作伙伴</span>
				<a href="#">JavaScript工具包</a>
				<a href="#">CSS驱动</a>
				<a href="#">CodingForums</a>
				<a href="#">CSS例子</a>
			</div>
			<div class="collapsed">
				<span class="menuSpan">测试电流</span>
				<a href="#">Current or not</a>
				<a href="#">Current or not</a>
				<a href="#">Current or not</a>
				<a href="#">Current or not</a>
			</div>
		</div>
	</body>
</html>
